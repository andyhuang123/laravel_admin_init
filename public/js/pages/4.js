webpackJsonp([4],{"3aIe":function(e,t,s){(e.exports=s("FZ+f")(!1)).push([e.i,".header-aside .icon[data-v-5b3643c3]{-ms-flex-negative:0;flex-shrink:0;width:44px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;font-size:1.2rem;cursor:pointer;color:#909399}.header-aside .icon[data-v-5b3643c3]:hover{color:#606266}.role-container[data-v-5b3643c3]{padding:15px;font-size:.875rem}.role-item[data-v-5b3643c3]{padding:30px 0}.role-item+.role-item[data-v-5b3643c3]{border-top:1px solid #f2f6fc}.role-item .item-title[data-v-5b3643c3],.role-item .item-tree-name[data-v-5b3643c3]{color:#303133}",""])},"4cro":function(e,t,s){(e.exports=s("FZ+f")(!1)).push([e.i,"[data-v-48b313af] .el-dialog__body{padding-top:15px;padding-bottom:15px;height:440px}.menu-tree-container[data-v-48b313af]{border:1px solid #f2f6fc;padding:6px 0}.tree-node[data-v-48b313af]{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:1;-ms-flex:auto;flex:auto;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:.875rem}.tree-node .node-info[data-v-48b313af]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;margin-right:30px}.tree-node .node-option[data-v-48b313af]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.tree-node .node-option-item[data-v-48b313af]{font-size:.75rem;margin-right:15px}.node-option[data-v-48b313af] .el-checkbox{margin-right:15px}.node-option[data-v-48b313af] .el-checkbox__label{font-size:.75rem;padding-left:7px}",""])},"535W":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-100"},[e.treeList.length&&"dle"==e.treeListLoading?s("vue-simplebar",[s("el-tree",{ref:"treeRole",attrs:{"highlight-current":"","node-key":"id",indent:18,data:e.treeList,props:e.treeProps,"expand-on-click-node":!1},on:{"current-change":e.selectNode},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,a=t.data;return s("div",{staticClass:"tree-node"},[s("div",{staticClass:"node-info"},[s("i",{staticClass:"el-icon-folder node-icon"}),e._v(e._s(a.name)+"\n                ")]),e._v(" "),s("el-dropdown",{staticClass:"node-option",attrs:{size:"small",trigger:"click",placement:"bottom"},on:{command:e.dialogNodeOption,"visible-change":e.nodeOptionVisibleChange}},[s("i",{staticClass:"el-icon-more",on:{click:function(t){return t.stopPropagation(),e.nodeOptionSelectNode(a,i)}}}),e._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e.hasParentPermission(a)?s("el-dropdown-item",{attrs:{command:"update"}},[s("i",{staticClass:"el-icon-folder"}),e._v(e._s(e.$t("action.edit"))+"\n                        ")]):e._e(),e._v(" "),e.hasParentPermission(a)?s("el-dropdown-item",{attrs:{command:"destroy"}},[s("i",{staticClass:"el-icon-folder-delete"}),e._v(e._s(e.$t("action.delete"))+"\n                        ")]):e._e(),e._v(" "),s("el-dropdown-item",{attrs:{command:"create"}},[s("i",{staticClass:"el-icon-folder-add"}),e._v(e._s(e.$t("system.permission.tree.create"))+"\n                        ")]),e._v(" "),s("el-dropdown-item",{attrs:{disabled:""}},[e._v("ID : "+e._s(a.id))])],1)],1)],1)}}])})],1):s("div",{staticClass:"p-2"},[s("component-page-loading",{attrs:{status:e.treeListLoading},on:{reload:e.getTreeList}})],1),e._v(" "),s("el-dialog",{attrs:{title:e.$t("system.permission.tree.dialog.create"),width:"400px",visible:e.dialog.visible.create},on:{"update:visible":function(t){return e.$set(e.dialog.visible,"create",t)}},nativeOn:{submit:function(e){e.preventDefault()}}},[s("div",{staticClass:"pr-5"},[s("el-form",{attrs:{model:e.dataCreate,"label-width":"80px"}},[s("el-form-item",{attrs:{label:e.$t("system.permission.tree.dialog.parent")}},[s("el-tag",{attrs:{type:"info",size:"mini"}},[e._v(e._s(e.dataCreate.parent_id))]),e._v(" "),s("span",{staticClass:"ml-1"},[e._v(e._s(e.dataCreate.parent_name))])],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("system.permission.tree.dialog.name"),error:Boolean(e.msg.errors.name)?e.msg.errors.name[0]:"",required:""}},[s("el-input",{model:{value:e.dataCreate.name,callback:function(t){e.$set(e.dataCreate,"name",t)},expression:"dataCreate.name"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.treeNodeCreate}},[e._v(e._s(e.$t("action.confirm")))]),e._v(" "),s("el-button",{on:{click:function(t){e.dialog.visible.create=!1}}},[e._v(e._s(e.$t("action.cancel")))])],1)],1)],1)]),e._v(" "),s("el-dialog",{attrs:{title:e.$t("system.permission.tree.dialog.update"),width:"400px",visible:e.dialog.visible.update},on:{"update:visible":function(t){return e.$set(e.dialog.visible,"update",t)}}},[s("div",{staticClass:"pr-5"},[s("el-form",{attrs:{model:e.dataUpdate,"label-width":"80px"}},[s("el-form-item",{attrs:{label:e.$t("system.permission.tree.dialog.sort"),error:Boolean(e.msg.errors.sort)?e.msg.errors.sort[0]:"",required:""}},[s("el-input",{attrs:{placeholder:e.$t("system.permission.tree.dialog.sortPlaceholder")},model:{value:e.dataUpdate.sort,callback:function(t){e.$set(e.dataUpdate,"sort",t)},expression:"dataUpdate.sort"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("system.permission.tree.dialog.name"),error:Boolean(e.msg.errors.name)?e.msg.errors.name[0]:"",required:""}},[s("el-input",{model:{value:e.dataUpdate.name,callback:function(t){e.$set(e.dataUpdate,"name",t)},expression:"dataUpdate.name"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.treeNodeUpdate}},[e._v(e._s(e.$t("action.confirm")))]),e._v(" "),s("el-button",{on:{click:function(t){e.dialog.visible.update=!1}}},[e._v(e._s(e.$t("action.cancel")))])],1)],1)],1)]),e._v(" "),s("el-dialog",{attrs:{title:e.$t("system.permission.tree.dialog.destroy"),center:"",width:"340px",visible:e.dialog.visible.destroy},on:{"update:visible":function(t){return e.$set(e.dialog.visible,"destroy",t)}}},[s("div",{staticClass:"text-center",domProps:{innerHTML:e._s(e.$t("confirm.tree-delete",{name:e.nodeCache.data.name}))}}),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"danger"},on:{click:e.treeNodeDestroy}},[e._v(e._s(e.$t("action.confirm")))]),e._v(" "),s("el-button",{on:{click:function(t){e.dialog.visible.destroy=!1}}},[e._v(e._s(e.$t("action.cancel")))])],1)])],1)},staticRenderFns:[]}},"7M12":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("ds9K"),a=s.n(i),n=s("Eeny"),o=s.n(n),r=s("KtyO"),d=s.n(r);t.default={components:{PermissionTree:a.a,PermissionUser:o.a,PermissionMenu:d.a},data:function(){return{tree:{}}},computed:{isSuperAdmin:function(){return this.$store.state.admin.user.isSuperAdmin}},methods:{treeSelectNode:function(e){this.tree=e}}}},"9QzJ":function(e,t,s){var i=s("ZQHw");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);s("rjj0")("249c3b4d",i,!0,{})},Eeny:function(e,t,s){var i=s("VU/8")(s("j2oq"),s("Rpxf"),!1,function(e){s("eX8O")},"data-v-1ae0163f",null);e.exports=i.exports},HCpg:function(e,t,s){var i=s("VU/8")(s("7M12"),s("K8Ot"),!1,function(e){s("lVdN")},"data-v-5b3643c3",null);e.exports=i.exports},K2sp:function(e,t,s){(e.exports=s("FZ+f")(!1)).push([e.i,"[data-v-1ae0163f] .el-dialog__body{min-height:440px;padding-top:15px;padding-bottom:15px}",""])},K8Ot:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page-container"},[s("div",{staticClass:"page-layout"},[s("div",{staticClass:"page-layout-header"},[s("div",{staticClass:"header-aside flex-start-title"},[s("div",{staticClass:"title"},[e._v(e._s(e.$t("system.permission.titleSide")))]),e._v(" "),e.isSuperAdmin?s("div",{staticClass:"option"},[s("div",{staticClass:"icon",attrs:{title:e.$t("system.permission.tree.create-root")},on:{click:function(t){return e.$refs.tree.dialogNodeOption("create-root")}}},[s("i",{staticClass:"el-icon-plus"})])]):e._e()]),e._v(" "),s("div",{staticClass:"header-main"},[s("div",{staticClass:"title"},[e._v(e._s(e.$t("system.permission.title")))])])]),e._v(" "),s("div",{staticClass:"page-layout-body"},[s("div",{staticClass:"body-aside"},[s("permission-tree",{ref:"tree",on:{click:e.treeSelectNode}})],1),e._v(" "),s("div",{staticClass:"body-main"},[s("vue-simplebar",[e.tree.id?s("div",{staticClass:"container"},[s("div",{staticClass:"role-container"},[s("div",{staticClass:"row role-item"},[s("div",{staticClass:"col-2"},[s("div",{staticClass:"item-title"},[e._v(e._s(e.$t("system.permission.name")))])]),e._v(" "),s("div",{staticClass:"col-10"},[s("div",{staticClass:"item-tree-name"},[e._v(e._s(e.tree.name))])])]),e._v(" "),s("permission-user",{attrs:{tree:e.tree}}),e._v(" "),s("permission-menu",{attrs:{tree:e.tree}})],1)]):s("div",{staticClass:"flex-center p-2"},[s("component-page-loading",{attrs:{status:"nodata"}})],1)])],1)])])])},staticRenderFns:[]}},KtyO:function(e,t,s){var i=s("VU/8")(s("nqH2"),s("SBe2"),!1,function(e){s("t4pw")},"data-v-48b313af",null);e.exports=i.exports},Rpxf:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row role-item"},[s("div",{staticClass:"col-2"},[s("div",{staticClass:"item-title"},[e._v(e._s(e.$t("system.permission.users.title")))])]),e._v(" "),s("div",{staticClass:"col-8"},[["loading","error"].indexOf(e.userListStatus)>=0?s("component-page-loading",{attrs:{status:e.userListStatus},on:{reload:e.getUsers}}):e.userList.length?s("div",{staticClass:"nub-list"},e._l(e.userList,function(t,i){return s("div",{key:i,staticClass:"nub-item"},[s("div",{staticClass:"nub-icon icon-user"},[s("font-awesome-icon",{attrs:{icon:"user-tie"}})],1),e._v(" "),s("div",{staticClass:"nub-text"},[e._v(e._s(t.email))])])}),0):s("component-page-loading",{attrs:{status:"nodata"}})],1),e._v(" "),s("div",{staticClass:"col-2 text-right"},[s("a",{staticClass:"role-item-option",attrs:{href:"javascript:;"},on:{click:function(t){e.dialogVisible=!0}}},[e._v(e._s(e.$t("action.modify")))])]),e._v(" "),s("el-dialog",{attrs:{title:e.$t("system.permission.users.title"),width:"700px",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[s("div",{staticClass:"pb-3"},[e.userListCache.length?e._e():s("div",[s("component-page-loading",{attrs:{status:"nodata"}})],1),e._v(" "),e.userListCache.length?s("div",{staticClass:"nub-list"},e._l(e.userListCache,function(t,i){return s("div",{key:i,staticClass:"nub-item"},[s("div",{staticClass:"nub-icon icon-user"},[s("font-awesome-icon",{attrs:{icon:"user-tie"}})],1),e._v(" "),s("div",{staticClass:"nub-text"},[e._v(e._s(t.email))]),e._v(" "),s("div",{staticClass:"nub-close",on:{click:function(s){return e.tagCheckedDelete(t,i)}}},[s("i",{staticClass:"el-icon-close"})])])}),0):e._e()]),e._v(" "),s("div",{staticClass:"pb-3"},[s("el-input",{attrs:{placeholder:e.$t("system.permission.users.dialog.email"),clearable:""},on:{change:e.filterChange},model:{value:e.filterOption.keyword,callback:function(t){e.$set(e.filterOption,"keyword",t)},expression:"filterOption.keyword"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.filterChange},slot:"append"})],1)],1),e._v(" "),s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.dataList},on:{select:e.handleSelection,"select-all":e.handleSelectionAll}},[s("el-table-column",{attrs:{width:"80",type:"selection"}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("system.permission.users.dialog.email"),prop:"email"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{domProps:{innerHTML:e._s(e.$options.filters.hsFilterKeyword(t.row.email,e.filterOption.keyword))}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("system.permission.users.dialog.name"),prop:"name"}})],1),e._v(" "),e.dataMeta.total?s("div",{staticClass:"pt-2 text-right"},[s("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.filterOption.page,"page-size":e.filterOption.page_size,total:e.dataMeta.total},on:{"current-change":e.filterPageChange}})],1):e._e()],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(e._s(e.$t("action.cancel")))]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(e._s(e.$t("action.confirm")))])],1)])],1)},staticRenderFns:[]}},SBe2:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row role-item"},[s("div",{staticClass:"col-2"},[s("div",{staticClass:"item-title"},[e._v(e._s(e.$t("system.permission.menus.title")))])]),e._v(" "),s("div",{staticClass:"col-8"},[["loading","error"].indexOf(e.menuListStatus)>=0?s("component-page-loading",{attrs:{status:e.menuListStatus},on:{reload:e.getMenus}}):e.menuList.length?s("div",{staticClass:"menu-tree-container"},[s("el-tree",{attrs:{data:e.menuList,props:{children:"children",label:"name"},"expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var i=t.data;return s("div",{staticClass:"tree-node"},[s("div",{staticClass:"node-info"},[e._v(e._s(e.$t("menu."+i.route_name)))]),e._v(" "),null!=e.menuActionList[i.id]?s("div",{staticClass:"node-option"},e._l(e.menuActionList[i.id],function(t,i){return s("div",{key:i,staticClass:"node-option-item"},[e._v("\n                            "+e._s(e.$te("actions."+t.type+"."+t.action)?e.$t("actions."+t.type+"."+t.action):t.name)+"\n                        ")])}),0):e._e()])}}])})],1):s("component-page-loading",{attrs:{status:"nodata"}})],1),e._v(" "),s("div",{staticClass:"col-2 text-right"},[s("a",{staticClass:"role-item-option",attrs:{href:"javascript:;"},on:{click:function(t){e.dialogVisible=!0}}},[e._v(e._s(e.$t("action.modify")))])]),e._v(" "),s("el-dialog",{attrs:{title:e.$t("system.permission.menus.title"),width:"700px",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dataList.length&&"dle"==e.dataListLoading?e.dialogVisible?s("vue-simplebar",[s("el-tree",{ref:"treeMenu",attrs:{data:e.dataList,props:{children:"children",label:"name"},"expand-on-click-node":!1,"show-checkbox":"","node-key":"route_name","default-checked-keys":null==e.menus.route_names_leaf?[]:e.menus.route_names_leaf},on:{"check-change":e.menuCheckChange},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,a=t.data;return s("div",{staticClass:"tree-node"},[s("div",{staticClass:"node-info"},[e._v(e._s(e.$t("menu."+a.route_name)))]),e._v(" "),null!=e.menuActionsCache[a.id]?s("div",{staticClass:"node-option",on:{click:function(e){e.stopPropagation()}}},[s("el-checkbox-group",{attrs:{disabled:!i.checked},model:{value:e.menuActionsCache[a.id],callback:function(t){e.$set(e.menuActionsCache,a.id,t)},expression:"menuActionsCache[data.id]"}},e._l(e.dataActionList[a.id],function(t,i){return s("el-checkbox",{key:i,attrs:{size:"medium",label:t.menu_action}},[e._v("\n                                "+e._s(e.$te("actions."+t.type+"."+t.action)?e.$t("actions."+t.type+"."+t.action):t.name)+"\n                            ")])}),1)],1):e._e()])}}])})],1):e._e():s("div",{staticClass:"p-2"},[s("component-page-loading",{attrs:{status:e.dataListLoading},on:{reload:e.getDataList}})],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(e._s(e.$t("action.cancel")))]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(e._s(e.$t("action.confirm")))])],1)],1)],1)},staticRenderFns:[]}},ZQHw:function(e,t,s){(e.exports=s("FZ+f")(!1)).push([e.i,".tree-node[data-v-97857cc2]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:1;-ms-flex:auto;flex:auto;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:.875rem}.tree-node .node-info[data-v-97857cc2]{-webkit-box-flex:1;-ms-flex:auto;flex:auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tree-node .node-icon[data-v-97857cc2]{color:#c7daf1;margin-right:5px}.tree-node .node-option[data-v-97857cc2]{display:none;-ms-flex-negative:0;flex-shrink:0;text-align:center;width:50px}.el-tree-node.is-current>.el-tree-node__content .tree-node .node-option[data-v-97857cc2],.el-tree-node__content:hover .node-option[data-v-97857cc2]{display:inline-block}",""])},ds9K:function(e,t,s){var i=s("VU/8")(s("huiS"),s("535W"),!1,function(e){s("9QzJ")},"data-v-97857cc2",null);e.exports=i.exports},eX8O:function(e,t,s){var i=s("K2sp");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);s("rjj0")("21fca904",i,!0,{})},huiS:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"PermissionTree",data:function(){return{dataList:[],treeListLoading:"dle",treeList:[],treeProps:{label:"name",children:"children"},nodeCache:{data:{},node:{}},nodePreCache:{node:{},nodeKey:0},dialog:{visible:{create:!1,update:!1,destroy:!1}},dataCreate:{name:"",parent_id:0,parent_name:0},dataUpdate:{id:0,sort:0,name:""},msg:{code:200,message:"",errors:{}}}},computed:{isSuperAdmin:function(){return this.$store.state.admin.user.isSuperAdmin}},watch:{treeList:{deep:!0,handler:function(e,t){this.treeListLoading=this.treeList.length?"dle":"nodata"}}},created:function(){this.getTreeList()},methods:{getTreeList:function(){var e=this;this.treeListLoading="loading",axios.get("/system/permission/tree/getList").then(function(t){200==t.data.resp_msg.code?(e.treeList=t.data.resp_data.treeList,e.dataList=t.data.resp_data.dataList,e.$nextTick(function(){this.treeList.length&&(this.$refs.treeRole.setCurrentKey(this.treeList[0].id),this.selectNode(this.treeList[0]))})):e.treeListLoading="error"})},hasParentPermission:function(e){return null!=this.dataList[e.parent_id]||!!this.isSuperAdmin},selectNode:function(e){this.$emit("click",{id:e.id,name:e.name,parent_id:e.parent_id,isParentPermission:this.hasParentPermission(e)})},nodeUpdateOrDelete:function(e){if(this.nodeCache.node.key!=this.nodePreCache.nodeKey)return!1;_.isEmpty(e)?this.$emit("click",{}):this.selectNode(e)},nodeOptionSelectNode:function(e,t){this.nodeCache.data=e,this.nodeCache.node=t},nodeOptionVisibleChange:function(e){e?(this.nodePreCache.node=this.$refs.treeRole.getCurrentNode(),this.nodePreCache.nodeKey=this.$refs.treeRole.getCurrentKey(),this.$refs.treeRole.setCurrentKey(this.nodeCache.node.key)):this.$refs.treeRole.setCurrentKey(this.nodePreCache.nodeKey)},dialogNodeOption:function(e){switch(e){case"create-root":this.initDataCreateRoot(),this.dialog.visible.create=!0;break;case"create":this.initDataCreate(),this.dialog.visible.create=!0;break;case"update":this.initDataUpdate(),this.dialog.visible.update=!0;break;case"destroy":this.dialog.visible.destroy=!0}},initMsg:function(){this.msg.code=200,this.msg.message="",this.msg.errors={}},initDataCreateRoot:function(){this.initMsg(),this.dataCreate.name="",this.dataCreate.parent_id=0,this.dataCreate.parent_name=""},initDataCreate:function(){this.initMsg(),this.dataCreate.name="",this.dataCreate.parent_id=this.nodeCache.data.id,this.dataCreate.parent_name=this.nodeCache.data.name},initDataUpdate:function(){this.initMsg(),this.dataUpdate.id=this.nodeCache.data.id,this.dataUpdate.sort=this.nodeCache.data.sort,this.dataUpdate.name=this.nodeCache.data.name},treeNodeCreate:function(){var e=this;this.initMsg();var t=this.$loading();axios.post("/system/permission/tree/store",this.dataCreate).then(function(s){if(t.close(),200==s.data.resp_msg.code){e.$message({type:"success",message:e.$t("messages.succeeded",{status:e.$t("action.new")}),showClose:!0}),e.dialog.visible.create=!1;var i=s.data.resp_data;e.$set(e.dataList,i.id,i),0==i.parent_id?e.treeList.push(i):e.$refs.treeRole.append(i,e.nodeCache.node)}else _.includes([42e3],s.data.resp_msg.code)?e.msg=s.data.resp_msg:e.$message({type:"error",message:e.$t("messages.failed",{status:e.$t("action.new")}),showClose:!0})})},treeNodeUpdate:function(){var e=this;this.initMsg();var t=this.$loading();axios.post("/system/permission/tree/update",this.dataUpdate).then(function(s){t.close(),200==s.data.resp_msg.code?(e.$message({type:"success",message:e.$t("messages.succeeded",{status:e.$t("action.edit")}),showClose:!0}),e.dialog.visible.update=!1,e.treeNodeSyncData(s.data.resp_data),e.nodeUpdateOrDelete(s.data.resp_data)):_.includes([42e3],s.data.resp_msg.code)?e.msg=s.data.resp_msg:e.$message({type:"error",message:e.$t("messages.failed",{status:e.$t("action.edit")}),showClose:!0})})},treeNodeSyncData:function(e){this.dataList[e.id].name=e.name,this.dataList[e.id].sort=e.sort,this.nodeCache.data.name=e.name,this.nodeCache.data.sort=e.sort},treeNodeDestroy:function(){var e=this;this.dialog.visible.destroy=!1;var t=this.$loading();axios.post("/system/permission/tree/destroy",{id:this.nodeCache.data.id}).then(function(s){t.close(),200==s.data.resp_msg.code?(e.$message({type:"success",message:e.$t("messages.succeeded",{status:e.$t("action.delete")}),showClose:!0}),e.$delete(e.dataList,e.nodeCache.data.id),e.$refs.treeRole.remove(e.nodeCache.node),e.nodeUpdateOrDelete(null)):44221==s.data.resp_msg.code?e.$message({type:"warning",message:e.$t("messages.delete-agent-failed"),showClose:!0}):e.$message({type:"error",message:e.$t("messages.failed",{status:e.$t("action.delete")}),showClose:!0})})}}}},j2oq:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"PermissionUser",props:["tree"],data:function(){return{userListStatus:"dle",userList:[],userListCache:[],dialogVisible:!1,loading:!1,filterOption:{keyword:"",page:1,page_size:5},dataMeta:{total:0},dataList:[]}},watch:{tree:{deep:!0,immediate:!0,handler:function(e,t){this.getUsers()}},dialogVisible:function(e,t){e?this.userListCache=_.cloneDeep(this.userList):this.clearFilterOption()}},methods:{getUsers:function(){var e=this;this.userListStatus="loading",axios.get("/system/permission/tree-user/getUsers",{params:{tree_id:this.tree.id}}).then(function(t){200==t.data.resp_msg.code?(e.userList=t.data.resp_data,e.userListStatus="dle"):e.userListStatus="error"})},clearFilterOption:function(){this.filterOption.keyword="",this.filterOption.page=1,this.dataMeta.total=0,this.dataList=[]},filterChange:function(){this.filterOption.page=1,this.getDataList()},filterPageChange:function(e){this.filterOption.page=e,this.getDataList()},getDataList:function(){var e=this;this.loading=!0,axios.get("/system/permission/tree-user/getUserList",{params:this.filterOption}).then(function(t){200==t.data.resp_msg.code?(e.dataMeta=t.data.resp_data.meta,e.dataList=t.data.resp_data.data,e.$nextTick(function(){for(var e in this.$refs.multipleTable.clearSelection(),this.dataList)for(var t in this.userListCache)if(this.userListCache[t].id==this.dataList[e].id){this.$refs.multipleTable.toggleRowSelection(this.dataList[e]);break}})):e.$message({type:"error",message:e.$t("messages.failed",{status:e.$t("action.search")}),showClose:!0}),e.loading=!1})},onSubmit:function(){var e=this,t=this.$loading();axios.post("/system/permission/tree-user/update",{tree_id:this.tree.id,user_ids:_.map(this.userListCache,"id")}).then(function(s){t.close(),200==s.data.resp_msg.code?(e.$message({type:"success",message:e.$t("messages.succeeded",{status:e.$t("action.save")}),showClose:!0}),e.dialogVisible=!1,e.userList=s.data.resp_data):e.$message({type:"error",message:e.$t("messages.failed",{status:e.$t("action.save")}),showClose:!0})})},tagCheckedDelete:function(e,t){for(var s in this.userListCache.splice(t,1),this.dataList)if(this.dataList[s].id==e.id){this.$refs.multipleTable.toggleRowSelection(this.dataList[s]);break}},handleSelection:function(e,t){for(var s in this.userListCache)if(this.userListCache[s].id==t.id)return void this.userListCache.splice(s,1);this.userListCache.push(t)},handleSelectionAll:function(e){if(_.isEmpty(e)){var t=!0,s=!1,i=void 0;try{for(var a,n=this.dataList[Symbol.iterator]();!(t=(a=n.next()).done);t=!0){var o=a.value;for(var r in this.userListCache)if(this.userListCache[r].id==o.id){this.userListCache.splice(r,1);break}}}catch(e){s=!0,i=e}finally{try{!t&&n.return&&n.return()}finally{if(s)throw i}}}else{var d=!0,l=!1,c=void 0;try{for(var u,m=e[Symbol.iterator]();!(d=(u=m.next()).done);d=!0){var p=u.value,h=!1;for(var f in this.userListCache)if(this.userListCache[f].id==p.id){h=!0;break}h||this.userListCache.push(p)}}catch(e){l=!0,c=e}finally{try{!d&&m.return&&m.return()}finally{if(l)throw c}}}}}}},lVdN:function(e,t,s){var i=s("3aIe");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);s("rjj0")("692e0846",i,!0,{})},nqH2:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"PermissionMenu",props:["tree"],data:function(){return{menuListStatus:"dle",menuList:[],menus:{},menuActionList:{},menuActions:{},menuActionsCache:{},dialogVisible:!1,dataListLoading:"dle",dataList:[],dataActionList:{},dataActions:{}}},watch:{tree:{deep:!0,immediate:!0,handler:function(e,t){this.getMenus()}},dialogVisible:function(e,t){e?this.getDataList():(this.menuActionsCache={},this.dataActions={},this.dataActionList={},this.dataList=[],this.dataListLoading="dle")}},methods:{getMenus:function(){var e=this;this.menuListStatus="loading",axios.get("/system/permission/tree-menu/getMenus",{params:{tree_id:this.tree.id}}).then(function(t){200==t.data.resp_msg.code?(e.menuList=t.data.resp_data.menuList,e.menus=t.data.resp_data.menus,e.menuActionList=t.data.resp_data.menuActionList,e.menuActions=t.data.resp_data.menuActions,e.menuListStatus="dle"):e.menuListStatus="error"})},getDataList:function(){var e=this;this.dataListLoading="loading",axios.get("/system/permission/tree-menu/getMenuList",{params:{tree_id:this.tree.isParentPermission?this.tree.parent_id:this.tree.id}}).then(function(t){if(200==t.data.resp_msg.code){for(var s in e.dataList=t.data.resp_data.menuList,e.dataActionList=t.data.resp_data.menuActionList,e.dataActions=t.data.resp_data.menuActions,e.dataActionList)e.$set(e.menuActionsCache,s,e.menuActions[s]||[]);e.dataListLoading=e.dataList.length?"dle":"nodata"}else e.dataListLoading="error"})},menuCheckChange:function(e){if(null!=this.dataActions[e.id]){var t=this.$refs.treeMenu.getNode(e.route_name);this.$set(this.menuActionsCache,e.id,t.checked?this.dataActions[e.id]:[])}},onSubmit:function(){var e=this,t=this.$loading();axios.post("/system/permission/tree-menu/update",{tree_id:this.tree.id,menus:{route_names:_.concat(this.$refs.treeMenu.getCheckedKeys(),this.$refs.treeMenu.getHalfCheckedKeys()),route_names_leaf:this.$refs.treeMenu.getCheckedKeys(!0)},menu_actions:this.menuActionsCache}).then(function(s){t.close(),200==s.data.resp_msg.code?(e.$message({type:"success",message:e.$t("messages.succeeded",{status:e.$t("action.save")}),showClose:!0}),e.dialogVisible=!1,e.menuList=s.data.resp_data.menuList,e.menus=s.data.resp_data.menus,e.menuActionList=s.data.resp_data.menuActionList,e.menuActions=s.data.resp_data.menuActions):e.$message({type:"error",message:e.$t("messages.failed",{status:e.$t("action.save")}),showClose:!0})})}}}},t4pw:function(e,t,s){var i=s("4cro");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);s("rjj0")("71c8a7d5",i,!0,{})}});